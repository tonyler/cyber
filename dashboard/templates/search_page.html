{% extends 'base.html' %}

{% block title %}Search - Cybernetics{% endblock %}

{% block content %}
<div class="container">
    <h1>[ MEMBER SEARCH ]</h1>

    <div class="panel">
        <form method="get" action="{{ url_for('search_page') }}" style="display: flex; gap: 1rem; align-items: center;">
            <input type="text" name="q" value="{{ query }}" placeholder="ENTER DISCORD USERNAME..."
                   style="flex: 1;" autofocus>
            <button type="submit">SEARCH</button>
        </form>
    </div>

    {% if query %}
        {% if results %}
        <div class="panel">
            <h2>{{ results|length }} MEMBER(S) FOUND</h2>

            <div style="display: grid; gap: 1.5rem; margin-top: 2rem;">
                {% for member in results %}
                <div class="panel">
                    <h3>{{ member.discord_user|upper }}</h3>

                    <div style="display: grid; gap: 0.75rem; margin-top: 1rem;">
                        {% if member.x_handle %}
                        <div>
                            <span class="text-muted">X:</span>
                            <a href="https://x.com/{{ member.x_handle }}" target="_blank" rel="noopener noreferrer">
                                @{{ member.x_handle }}
                            </a>
                        </div>
                        {% endif %}

                        {% if member.reddit_username %}
                        <div>
                            <span class="text-muted">REDDIT:</span>
                            <a href="https://reddit.com/user/{{ member.reddit_username }}" target="_blank" rel="noopener noreferrer">
                                u/{{ member.reddit_username }}
                            </a>
                        </div>
                        {% endif %}

                        <div>
                            <span class="text-muted">STATUS:</span>
                            <span>{{ member.status|upper }}</span>
                        </div>

                        {% if member.joined_date %}
                        <div>
                            <span class="text-muted">JOINED:</span>
                            <span>{{ member.joined_date }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% else %}
        <div class="panel text-center">
            <h3>NO RESULTS</h3>
            <p class="text-muted mt-2">"{{ query }}"</p>
            <p class="text-muted">TRY A DIFFERENT SEARCH TERM</p>
        </div>
        {% endif %}
    {% else %}
    <div class="panel text-center">
        <h3>SEARCH DATABASE</h3>
        <p class="text-muted mt-2">ENTER A DISCORD USERNAME TO BEGIN</p>
    </div>
    {% endif %}
</div>
{% endblock %}
